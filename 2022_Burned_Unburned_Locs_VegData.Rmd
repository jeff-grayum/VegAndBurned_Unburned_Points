---
title: "Burned_Unburned_Locs_VegData"
output: html_document
date: "2023-09-11"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(janitor)
library(tidyverse)
library(ggthemes)
library(lubridate)
library(lme4)
library(readxl)
library(writexl)
library(sf)
library(MuMIn)
library(sjPlot)
library(rsq)
library(betareg)
library(broom)
theme_set(theme_minimal())
```

Importing datasets
```{r}
veg_data_2022 <- read_xlsx("/Volumes/Samsung_T5/BOBWHITE_DATA/Clean/VegSurveys2022.xlsx") %>%
  clean_names() %>%
  mutate(date = as.Date(date)) %>%
  dplyr::filter(date > "2022-04-11")

summer_locs <- read_xlsx("/Volumes/Samsung_T5/BOBWHITE_DATA/Clean/summer_2022_locs_burned_and_unburned_clean.xlsx") %>%
  mutate(date = as.Date(date))%>%
  dplyr::filter(date > "2022-04-11") %>%
  arrange(date) %>%
  as_tibble() %>%
  view()
```

First, lets summarize our veg data so we have average values for each date, rather than 50 samples.
```{r}
veg_data_2022_summary <- veg_data_2022 %>%
  group_by(date) %>%
  summarize(pg = median(percent_grasses),
            pf = median(percent_forbs),
            ps = median(percent_shrubs),
            hg = median(max_grasses_cm),
            hf = median(max_forbs_cm),
            hs = median(max_shrubs_cm)) %>%
  as_tibble()

view(veg_data_2022_summary)
```

Lets add a distance to edge column for our points (Not sure if locations outside of burned areas should be negative?)
```{r}
#Importing map of burned areas, summer 2022.
#Reading burn compartments in again, but as an sf object
burn_compartments_2022 <- st_read("/Volumes/Samsung_T5/BOBWHITE_DATA/Maps/2022_burn_compartments/Polygons/2022_BurnedUnits_minusAG2.shp")

# Converting burn_compartments_2022 polygons to line geometries that represent their boundaries. This is necessary to calc min distances later.
burn_compartment_boundaries <- st_boundary(burn_compartments_2022)

# Converting tibble of points to an sf object
summer_locs_sf <- st_as_sf(summer_locs, coords = c("easting", "northing"), crs = st_crs(burn_compartments_2022))

# Calculating the distance from each point to the nearest line boundary of the burn compartments, storing it in matrix
distance_matrix <- st_distance(summer_locs_sf, burn_compartment_boundaries)

# Applying the function min() to each row (1 does this -- we'd use 2 for columns) in the distance matrix
min_distances <- apply(distance_matrix, 1, min)

# Add the minimum distance to the original tibble as a new column
summer_locs$distance_to_edge <- min_distances

#Printing
print(summer_locs)

#This looks right, and similar to what we got in other analysis.
summer_locs %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(DSF, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "DSF",
       y = "Distance to edge (m)",
       title = "Distance to edge following prescribed fire",
       subtitle = "Only looking at birds within burned units")

summer_locs %>%
  dplyr::filter(burned == 1) %>%
  summarize(mean_distance = mean(distance_to_edge))


summer_locs %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(distance_to_edge)) +
  geom_histogram(binwidth = 10, fill = "midnight blue", alpha = 0.8) + 
  geom_vline(xintercept = 27.8, linetype = "dashed", color = "gray") +
  labs(x = "Distance to edge",
       y = "",
       title = "Distances to edge following prescribed fire",
       subtitle = "Only looking at birds within burn compartments")

  

summer_locs %>%
  dplyr::filter(burned == 0) %>%
  ggplot(aes(DSF, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "DSF",
       y = "Distance to edge",
       title = "Distance to edge of burned compartments following prescribed fire",
       subtitle = "Only looking at birds located in unburned units")

summer_locs %>%
  dplyr::filter(burned == 0) %>%
  summarize(mean_distance = mean(distance_to_edge))


summer_locs %>%
  dplyr::filter(burned == 0) %>%
  ggplot(aes(distance_to_edge)) +
  geom_histogram(binwidth = 20, fill = "midnight blue", alpha = 0.8) + 
  geom_vline(xintercept = 96.9, linetype = "dashed", color = "gray") +
  labs(x = "Distance to edge",
       y = "",
       title = "Distances to edge following prescribed fire",
       subtitle = "Only looking at birds in unburned compartments")

summer_locs %>%
  mutate(burned = factor(burned, labels = c("Unburned", "Burned"))) %>%
  ggplot(aes(x = burned, y = distance_to_edge)) +
  geom_boxplot(fill = "midnight blue", alpha = 0.5) +
  labs(x = "Burn Status",
       y = "Distance to Edge",
       title = "Distance to edge of burn compartments following prescribed fire")

summer_locs %>%
  mutate(burned = factor(burned, labels = c("Unburned", "Burned"))) %>%
  ggplot(aes(x = burned, y = distance_to_edge)) +
  geom_violin(fill = "midnight blue", alpha = 0.5) +
  labs(x = "Burn Status",
       y = "Distance to Edge",
       title = "Distance to edge following prescribed fire")

```

Lets add in age and sex info for our location data. This may be useful later.
```{r}
#The fate spreadsheet has age and sex info for each bird.
#Importing "fate" spreadsheet
fate <- rio::import("/Volumes/Samsung_T5/BOBWHITE_DATA/Clean/fate_clean_2021_22.xlsx", setclass = "tibble") %>%
  clean_names() %>%
  rename(band_numb = band_number) 

#Now we bind age and sex into locations, based on band_numb
summer_locs <- summer_locs %>%
  left_join(fate %>% 
              dplyr::select(band_numb, age, sex), 
            by = "band_numb")
```

Trying to join veg summary data with Summer 2022 locations.
We have locations almost everyday, but veg data only once a week. 
First, we will try adding a column "week" to join by (this looks like it worked).
```{r}
#Adding week column to each tibble
summer_locs$week <- week(summer_locs$date)
veg_data_2022_summary$week <- week(veg_data_2022_summary$date)

#I am surprised this worked.
summer_locs %>%
  view()
veg_data_2022_summary %>%
  view()

#Now, we join based on week.
summer_locs_veg_data <- inner_join(summer_locs, veg_data_2022_summary, by = "week")

#taking a look
summer_locs_veg_data %>%
  view()

summer_locs_veg_data <- summer_locs_veg_data%>%
  rename(date = date.x,
         start_date_of_week = date.y)

#write_xlsx(summer_locs_veg_data, "/Volumes/Samsung_T5/BOBWHITE_DATA/Clean/summer_locs_veg_dataFIXEDdistances.xlsx")
```

Trying to determine the proportion of bobwhite that were signaled in burned areas each day (birds in burned areas/unique band numbers signaled that week)
```{r}
# Counting birds online each week
birds_online_each_week <- summer_locs_veg_data %>%
  group_by(week) %>%
  summarize(birds_online = n_distinct(band_numb))

# Adding count to tibble
summer_locs_veg_data <- summer_locs_veg_data %>%
  left_join(birds_online_each_week, by = "week")

# Handling NA values for birds_online
summer_locs_veg_data$birds_online[is.na(summer_locs_veg_data$birds_online)] <- 0

# Counting unique birds signaled within a burned area each day
birds_in_burned_areas_each_day <- summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  group_by(date) %>%
  summarize(birds_in_burned_area = n_distinct(band_numb))

# Joining into summer locs data
summer_locs_veg_data <- summer_locs_veg_data %>%
  left_join(birds_in_burned_areas_each_day, by = "date")

# Handling NA values for birds_in_burned_area
summer_locs_veg_data$birds_in_burned_area[is.na(summer_locs_veg_data$birds_in_burned_area)] <- 0

# Calculate percentage of birds in burned areas
summer_locs_veg_data_perc_burned <- summer_locs_veg_data %>%
  mutate(percent_in_burned = (birds_in_burned_area / birds_online))

# Handling NA values for percent_in_burned
summer_locs_veg_data_perc_burned$percent_in_burned[is.na(summer_locs_veg_data_perc_burned$percent_in_burned)] <- 0


ave_burned_per_week <- summer_locs_veg_data_perc_burned %>%
  group_by(week) %>%
  summarize(mean_per_burned = mean(percent_in_burned))


ave_burned_per_week %>%
  mutate(week = (week - 15)) %>%
  dplyr::filter(week <=15) %>%
  ggplot(aes(week, mean_per_burned)) +
  geom_line() +
  labs(x = "Weeks following prescribed fire",
       y = "Mean percentage of birds online that were located in burned areas",
       title = "Average percentage of birds online that were located in burned areas each week")

```

Plotting veg data vs percent in burned area
```{r}
summer_locs_veg_data_perc_burned %>%
  dplyr::filter(week <= 30) %>%
  ggplot(aes(date, percent_in_burned)) +
  geom_point() +
  geom_smooth()

#summer_locs_veg_data_perc_burned %>%
  #ggplot(aes(percent_in_burned)) +
  #geom_histogram(bins = 10)

#Trying to run a mixed-model.
#First, we gotta standardize our covariates
#Doing this in two steps.. one step for percent cover class, one for max height. Not sure if this is even necessary.
summer_locs_veg_data_perc_burned_modified <- summer_locs_veg_data_perc_burned %>% 
  mutate_at(vars(pg:hs,
                 DSF), .funs = function(x){as.numeric(scale(x, center = T))}) %>%
  mutate(percent_in_burned = percent_in_burned + 0.0001)

```

Deciding between normal or regular distribution
```{r}
#### Normal vs Beta distribution #### 

#Normal distribution
perc_burn_area_global_normal <- glm(percent_in_burned ~ 
                                pf + 
                                ps + 
                                hg + 
                                hf + 
                                hs +
                                DSF,
                 data = summer_locs_veg_data_perc_burned_modified,
                 na.action = "na.pass")

summary(perc_burn_area_global_normal)
AIC_norm <- AIC(perc_burn_area_global_normal)
rsq(perc_burn_area_global_normal)

normal.model.diag.metrics <- augment(perc_burn_area_global_normal)
head(normal.model.diag.metrics)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_normal)
mtext("Normal Distribution", outer = TRUE, line = -1, cex = 1.5)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_normal, 1)
mtext("Normal distribution", line = +2)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_normal, 2)
mtext("Normal distribution", line = +2)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_normal, 3)
mtext("Normal distribution", line = +2)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_normal, 4)
mtext("Normal distribution", line = +2)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_normal, 5)
mtext("Normal distribution", line = +2)

#Add observations indices and
#drop some columns (.se.fit, .sigma) for simplification
normal.model.diag.metrics <- normal.model.diag.metrics %>%
  mutate(index = 1:nrow(normal.model.diag.metrics)) %>%
  select(index, everything())

#Inspect the data
head(normal.model.diag.metrics, 4)


#Beta distribution
perc_burn_area_global_beta <- betareg(percent_in_burned ~ 
                                pg +
                                pf + 
                                ps + 
                                hg + 
                                hf + 
                                hs +
                                DSF,
                 data = summer_locs_veg_data_perc_burned_modified,
                 na.action = "na.pass")

summary(perc_burn_area_global_beta)
AIC_beta <- AIC(perc_burn_area_global_beta)

beta.model.diag.metrics <- augment(perc_burn_area_global_beta)
head(normal.model.diag.metrics)

par(mfrow = c(2, 2))
plot(perc_burn_area_global_beta)
mtext("Beta", outer = TRUE, line = -1, cex = 1.5)

par(mfrow = c(2, 2))
plot(fitted(perc_burn_area_global_beta), residuals(perc_burn_area_global_beta, type = "pearson"))
mtext("Beta", outer = TRUE, line = -1, cex = 1.5)

par(mfrow = c(2, 2))
plot(fitted(perc_burn_area_global_beta), residuals(perc_burn_area_global_beta, type = "deviance"))
mtext("Beta", outer = TRUE, line = -1, cex = 1.5)

par(mfrow = c(2, 2))
qqnorm(residuals(perc_burn_area_global_beta, type = "pearson"))
qqline(residuals(perc_burn_area_global_beta, type = "pearson"))
mtext("Beta", outer = TRUE, line = -1, cex = 1.5)



#Add observations indices and
#drop some columns (.se.fit, .sigma) for simplification
beta.model.diag.metrics <- beta.model.diag.metrics %>%
  mutate(index = 1:nrow(normal.model.diag.metrics)) %>%
  select(index, everything())

#Inspect the data
head(normal.model.diag.metrics, 4)






```


```{r}
summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(hg, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "Median height of grasses",
       y = "Distance to edge",
       title = "Grass height vs Dist to Edge")

summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(hf, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "Median height of forbs",
       y = "Distance to edge",
       title = "Forb height vs Dist to Edge")

summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(hs, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "Median height of shrubs",
       y = "Distance to edge",
       title = "Shrub height vs Dist to Edge")

summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(pg, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "Median percent cover of grasses",
       y = "Distance to edge",
       title = "Percent cover grass vs Dist to Edge")

summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(pf, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "Median percent cover of forbs",
       y = "Distance to edge",
       title = "Percent cover forbs vs Dist to Edge")

summer_locs_veg_data %>%
  dplyr::filter(burned == 1) %>%
  ggplot(aes(ps, distance_to_edge)) +
  geom_point() +
  geom_smooth() +
  labs(x = "Median percent cover of shrubs",
       y = "Distance to edge",
       title = "Percent cover shrubs vs Dist to Edge")
```

Lets try our candidate models with our normal distribution.
```{r}
#### Candidate models, normal distribution ####
#Global model
globalmodel <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps + 
                     hg + 
                     hf + 
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")


# Model 1 (all veg influences use of burned areas... not include hs because correlated with ps)
model1 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps + 
                     hg + 
                     hf, 
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 2 (only looking at herbaceous veg components)
model2 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 3 only grass influences use
model3 <- glm(percent_in_burned ~
                     pg + 
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 4 only forbs influence use 
model4 <- glm(percent_in_burned ~
                     pf +  
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 5 Height of herbaceous veg influencing use
model5 <- glm(percent_in_burned ~
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 6 percent of cover of herb veg influencing use
model6 <- glm(percent_in_burned ~
                     pg + 
                     pf +  
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 7, pecent grasses influence use 
model7 <- glm(percent_in_burned ~
                     pg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 8, height grasses influence use 
model7 <- glm(percent_in_burned ~
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 8, perc forbs influences use
model8 <- glm(percent_in_burned ~
                     pf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 9, height forbs influences use 
model9 <- glm(percent_in_burned ~
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 10 Shrubby height and cover influences use
model10 <- glm(percent_in_burned ~
                     ps +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 11 percent of shrubs is most influential
model11 <- glm(percent_in_burned ~
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 12 height of shurbs is most influential
model12 <- glm(percent_in_burned ~
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 13 Height of all veg cover most influences use.
model13 <- glm(percent_in_burned ~
                     hg +
                     hf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 14 percent cover of all veg cover most influences use.
model14 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 15 Height of grasses, percent forbs (grow "out" more than "up"), and height of shrubs.
model15 <- glm(percent_in_burned ~
                     hg +
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 16, same as above, but percent shrubs may be more influential with this combination.
model16 <- glm(percent_in_burned ~
                     hg +
                     pf +
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 17, percent grasses, percent forbs, and height shrubs
model17 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 18, only height grasses and height shrubs (vertical cover)
model18 <- glm(percent_in_burned ~
                     hg +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 19, horizontal cover from forbs, vertical from shrubs
model19 <- glm(percent_in_burned ~
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 20, horizontal cover from forbs, vertical from grass
model20 <- glm(percent_in_burned ~
                     pf +
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 21, height of grasses and shrubs
model21 <- glm(percent_in_burned ~
                     pf +
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")


# Model 22 (only looking at herbaceous veg components, but with DSF)
model22 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     hg + 
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 23 only grass influences use, along with DSF
model23 <- glm(percent_in_burned ~
                     pg + 
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 24 only forbs influence use, plus DSF
model24 <- glm(percent_in_burned ~
                     pf +  
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 25 Height of herbaceous veg influencing use, plus DSF
model25 <- glm(percent_in_burned ~
                     hg + 
                     hf +
                     DSF, 
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 26 percent of cover of herb veg influencing use, along with DSF
model26 <- glm(percent_in_burned ~
                     pg + 
                     pf +  
                     hg + 
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 27, percent grasses influence use, plus DSF
model27 <- glm(percent_in_burned ~
                     pg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 28, height grasses influence use, plus DSF
model28 <- glm(percent_in_burned ~
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 29, perc forbs influences use, including DSF
model29 <- glm(percent_in_burned ~
                     pf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 30, height forbs influences use 
model30 <- glm(percent_in_burned ~
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

# Model 31 Shrubby height and cover influences use, including DSF
model31 <- glm(percent_in_burned ~
                     ps +
                     #hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 32 percent of shrubs is most influential, including DSF
model32 <- glm(percent_in_burned ~
                     ps +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 33 height of shurbs is most influential, along with DSF
model33 <- glm(percent_in_burned ~
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 34 Height of all veg cover most influences use, including DSF.
model34 <- glm(percent_in_burned ~
                     hg +
                     hf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 35 percent cover of all veg cover most influences use, with DSF.
model35 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 36 Height of grasses, percent forbs (grow "out" more than "up"), and height of shrubs. Also, DSF
model36 <- glm(percent_in_burned ~
                     hg +
                     pf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")
AIC(model36)

#Model 37, same as above, but percent shrubs may be more influential with this combination. Including DSF this time
model37 <- glm(percent_in_burned ~
                     hg +
                     pf +
                     ps +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 38, percent grasses, percent forbs, and height shrubs. Plus DSF
model38 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 39, only height grasses and height shrubs (vertical cover). With DSF.
model39 <- glm(percent_in_burned ~
                     hg +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 40, horizontal cover from forbs, vertical from shrubs. Including DSF
model40 <- glm(percent_in_burned ~
                     pf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 41, horizontal cover from forbs, vertical from grass. Including DSF
model41 <- glm(percent_in_burned ~
                     pf +
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 42, height of grasses and shrubs, plus DSF
model42 <- glm(percent_in_burned ~
                     pf +
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 43, all veg except height grass. Maybe vertical cover from thin blades of grass isn't important
model43 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps + 
                     hf + 
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 44, all veg except height grass height forbs. Maybe forbs provide better horizontal cover
model44 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps + 
                     hg, 
                     #hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#Model 45, all veg except height grass height forbs. Maybe forbs provide better horizontal cover
model45 <- glm(percent_in_burned ~
                     pg +
                     pf +
                     ps +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

#model 46, only DSF
model46 <- glm(percent_in_burned ~
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass",
                     family = "gaussian")

```

Ranking normal candidate models by AIC
```{r}
#### ranking normal models ####
# Creating a data frame to store model names and their AIC values
model_names <- c("globalmodel", paste0("model", 1:46))


model_list <- list(globalmodel, model1, model2, model3, model4,
                   model5, model6, model7, model8, model9,
                   model10, model11, model12, model13, model14,
                   model15, model16, model17, model18, model19,
                   model20, model21, model22, model23, model24,
                   model25, model26, model27, model28, model29,
                   model30, model31, model32, model33, model34,
                   model35, model36, model37, model38, model39,
                   model40, model41, model42, model43, model44, model45, model46)



model_aic <- sapply(model_list, AIC)

# Combine the model names and AIC values into a data frame
model_comparison <- data.frame(Model = model_names, AIC = model_aic)

# Sort the models by AIC value
model_comparison_sorted <- model_comparison %>% 
  arrange(AIC)

# View the sorted data frame
model_comparison_sorted %>% 
  view()

# Calculate the minimum AIC value among all models
min_aic <- min(model_comparison_sorted$AIC)

# Add a column for Delta AIC
model_comparison_sorted <- model_comparison_sorted %>%
  mutate(Delta_AIC = AIC - min_aic)

# View the updated data frame
model_comparison_sorted %>% view()


```

candidate models w beta distribution
```{r}
#### candidate models with beta distribution ####
#Global model
globalmodel <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     ps +    
                     hg + 
                     hf + 
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     


# Model 1 (all veg influences veg)
model1 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     ps + 
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 2 (only looking at herbaceous veg components)
model2 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 3 only grass influences use
model3 <- betareg(percent_in_burned ~
                     pg + 
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 4 only forbs influence use 
model4 <- betareg(percent_in_burned ~
                     pf +  
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 5 Height of herbaceous veg influencing use
model5 <- betareg(percent_in_burned ~
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 6 percent of cover of herb veg influencing use
model6 <- betareg(percent_in_burned ~
                     pg + 
                     pf +  
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 7, pecent grasses influence use 
model7 <- betareg(percent_in_burned ~
                     pg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 8, height grasses influence use 
model7 <- betareg(percent_in_burned ~
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 8, perc forbs influences use
model8 <- betareg(percent_in_burned ~
                     pf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 9, height forbs influences use 
model9 <- betareg(percent_in_burned ~
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 10 Shrubby height and cover influences use
model10 <- betareg(percent_in_burned ~
                     ps +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 11 percent of shrubs is most influential
model11 <- betareg(percent_in_burned ~
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 12 height of shurbs is most influential
model12 <- betareg(percent_in_burned ~
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 13 Height of all veg cover most influences use.
model13 <- betareg(percent_in_burned ~
                     hg +
                     hf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 14 percent cover of all veg cover most influences use.
model14 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 15 Height of grasses, percent forbs (grow "out" more than "up"), and height of shrubs.
model15 <- betareg(percent_in_burned ~
                     hg +
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 16, same as above, but percent shrubs may be more influential with this combination.
model16 <- betareg(percent_in_burned ~
                     hg +
                     pf +
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 17, percent grasses, percent forbs, and height shrubs
model17 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 18, only height grasses and height shrubs (vertical cover)
model18 <- betareg(percent_in_burned ~
                     hg +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 19, horizontal cover from forbs, vertical from shrubs
model19 <- betareg(percent_in_burned ~
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 20, horizontal cover from forbs, vertical from grass
model20 <- betareg(percent_in_burned ~
                     pf +
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 21, height of grasses and shrubs
model21 <- betareg(percent_in_burned ~
                     hg +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     


# Model 22 (only looking at herbaceous veg components, but with DSF)
model22 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     hg + 
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 23 only grass influences use, along with DSF
model23 <- betareg(percent_in_burned ~
                     pg + 
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 24 only forbs influence use, plus DSF
model24 <- betareg(percent_in_burned ~
                     pf +  
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 25 Height of herbaceous veg influencing use, plus DSF
model25 <- betareg(percent_in_burned ~
                     hg + 
                     hf +
                     DSF, 
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 26 percent of cover of herb veg influencing use, along with DSF
model26 <- betareg(percent_in_burned ~
                     pg + 
                     pf +  
                     hg + 
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 27, percent grasses influence use, plus DSF
model27 <- betareg(percent_in_burned ~
                     pg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 28, height grasses influence use, plus DSF
model28 <- betareg(percent_in_burned ~
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 29, perc forbs influences use, including DSF
model29 <- betareg(percent_in_burned ~
                     pf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 30, height forbs influences use 
model30 <- betareg(percent_in_burned ~
                     hf +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

# Model 31 Shrubby height and cover influences use, including DSF
model31 <- betareg(percent_in_burned ~
                     ps +
                     #hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 32 percent of shrubs is most influential, including DSF
model32 <- betareg(percent_in_burned ~
                     ps +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 33 height of shurbs is most influential, along with DSF
model33 <- betareg(percent_in_burned ~
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 34 Height of all veg cover most influences use, including DSF.
model34 <- betareg(percent_in_burned ~
                     hg +
                     hf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 35 percent cover of all veg cover most influences use, with DSF.
model35 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     ps +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 36 Height of grasses, percent forbs (grow "out" more than "up"), and height of shrubs. Also, DSF
model36 <- betareg(percent_in_burned ~
                     hg +
                     pf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")


#Model 37, same as above, but percent shrubs may be more influential with this combination. Including DSF this time
model37 <- betareg(percent_in_burned ~
                     hg +
                     pf +
                     ps +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 38, percent grasses, percent forbs, and height shrubs. Plus DSF
model38 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 39, only height grasses and height shrubs (vertical cover). With DSF.
model39 <- betareg(percent_in_burned ~
                     hg +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 40, horizontal cover from forbs, vertical from shrubs. Including DSF
model40 <- betareg(percent_in_burned ~
                     pf +
                     hs +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 41, horizontal cover from forbs, vertical from grass. Including DSF
model41 <- betareg(percent_in_burned ~
                     pf +
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 42, height of grasses and shrubs, plus DSF
model42 <- betareg(percent_in_burned ~
                     pf +
                     hg +
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 43, all veg except height grass. Maybe vertical cover from thin blades of grass isn't important
model43 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     ps + 
                     hf + 
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 44, all veg except height grass height forbs. Maybe forbs provide better horizontal cover
model44 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     hg + 
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#Model 45, all veg except height grass height forbs. Maybe forbs provide better horizontal cover
model45 <- betareg(percent_in_burned ~
                     pg +
                     pf +
                     ps +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     

#model 46, only DSF
model46 <- betareg(percent_in_burned ~
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     na.action = "na.pass")
                     
```

```{r}
#### ranking beta models ####
# Creating a data frame to store model names and their AIC values
model_names <- c("globalmodel", paste0("model", 1:46))


model_list <- list(globalmodel, model1, model2, model3, model4,
                   model5, model6, model7, model8, model9,
                   model10, model11, model12, model13, model14,
                   model15, model16, model17, model18, model19,
                   model20, model21, model22, model23, model24,
                   model25, model26, model27, model28, model29,
                   model30, model31, model32, model33, model34,
                   model35, model36, model37, model38, model39,
                   model40, model41, model42, model43, model44, model45, model46)


model_aic <- sapply(model_list, AIC)

# Combine the model names and AIC values into a data frame
model_comparison <- data.frame(Model = model_names, AIC = model_aic)

# Sort the models by AIC value
model_comparison_sorted <- model_comparison %>% 
  arrange(AIC)

# View the sorted data frame
model_comparison_sorted %>% 
  view()

# Calculate the minimum AIC value among all models
min_aic <- min(model_comparison_sorted$AIC)

# Add a column for Delta AIC
model_comparison_sorted <- model_comparison_sorted %>%
  mutate(Delta_AIC = AIC - min_aic)

# View the updated data frame
model_comparison_sorted %>% view()
```

Now looking at all models with binomial distribution
```{r}
#### candidate models, binomial distribution ####
#Global model
globalmodel <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     ps +    
                     hg + 
                     hf + 
                     DSF,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 1
model1 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     ps + 
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 2
model2 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 3
model3 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg + 
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 4
model4 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pf +  
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 5
model5 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 6
model6 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg + 
                     pf +  
                     hg + 
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 7
model7 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 8
model8 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 9
model9 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hf,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 10
model10 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     ps +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 11
model11 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 12
model12 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 13
model13 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     hf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 14
model14 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 15
model15 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 16
model16 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     pf +
                     ps,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 17
model17 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 18
model18 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 19
model19 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pf +
                     hs,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")

# Model 20
model20 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pf +
                     hg,
                     data = summer_locs_veg_data_perc_burned_modified,
                     family = binomial,
                     na.action = "na.pass")


#Model 21, height of grasses and shrubs
model21 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     hs,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 22 (only looking at herbaceous veg components, but with DSF)
model22 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     hg + 
                     hf +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 23 only grass influences use, along with DSF
model23 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg + 
                     hg +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 24 only forbs influence use, plus DSF
model24 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pf +  
                     hf +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 25 Height of herbaceous veg influencing use, plus DSF
model25 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg + 
                     hf +
                     DSF, 
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 26 percent of cover of herb veg influencing use, along with DSF
model26 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg + 
                     pf +  
                     hg + 
                     hf +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 27, percent grasses influence use, plus DSF
model27 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 28, height grasses influence use, plus DSF
model28 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 29, perc forbs influences use, including DSF
model29 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pf +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 30, height forbs influences use 
model30 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hf +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 31 Shrubby height and cover influences use, including DSF
model31 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 32 percent of shrubs is most influential, including DSF
model32 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 33 height of shurbs is most influential, along with DSF
model33 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 34 Height of all veg cover most influences use, including DSF.
model34 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     hf +
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 35 percent cover of all veg cover most influences use, with DSF.
model35 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 36 Height of grasses, percent forbs (grow "out" more than "up"), and height of shrubs. Also, DSF
model36 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     pf +
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 37, same as above, but percent shrubs may be more influential with this combination. Including DSF this time
model37 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     pf +
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 38, percent grasses, percent forbs, and height shrubs. Plus DSF
model38 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 39, only height grasses and height shrubs (vertical cover). With DSF.
model39 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 40, only percent grasses and percent shrubs (horizontal cover). Including DSF.
model40 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 41, grasses and shrubs
model41 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     ps +  
                     hg + 
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

AIC(model41)

# Model 42, height of grasses, height of forbs, and percent shrubs, plus DSF
model42 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     hf +
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 43, height of grasses, percent forbs, and percent shrubs, plus DSF
model43 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     hg +
                     pf +
                     ps +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 44, percent grasses, height of forbs, and height of shrubs, plus DSF
model44 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     hf +
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 45, percent grasses, percent forbs, and height of shrubs. Plus DSF.
model45 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     pg +
                     pf +
                     hs +
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")

# Model 46, only DSF
model46 <- glm(cbind(birds_in_burned_area, birds_online - birds_in_burned_area) ~
                     DSF,
                     family = binomial, data = summer_locs_veg_data_perc_burned_modified, na.action = "na.pass")


```

Looking at results of binomial models
```{r}
#### ranking binomial models ####
# Creating a data frame to store model names and their AIC values
model_names <- c("globalmodel", paste0("model", 1:46))


model_list <- list(globalmodel, model1, model2, model3, model4,
                   model5, model6, model7, model8, model9,
                   model10, model11, model12, model13, model14,
                   model15, model16, model17, model18, model19,
                   model20, model21, model22, model23, model24,
                   model25, model26, model27, model28, model29,
                   model30, model31, model32, model33, model34,
                   model35, model36, model37, model38, model39,
                   model40, model41, model42, model43, model44, model45, model46)


model_aic <- sapply(model_list, AIC)

# Combine the model names and AIC values into a data frame
model_comparison <- data.frame(Model = model_names, AIC = model_aic)

# Sort the models by AIC value
model_comparison_sorted <- model_comparison %>% 
  arrange(AIC)

# View the sorted data frame
model_comparison_sorted %>% 
  view()

# Calculate the minimum AIC value among all models
min_aic <- min(model_comparison_sorted$AIC)

# Add a column for Delta AIC
model_comparison_sorted <- model_comparison_sorted %>%
  mutate(Delta_AIC = AIC - min_aic)

# View the updated data frame
model_comparison_sorted %>% view()
```




